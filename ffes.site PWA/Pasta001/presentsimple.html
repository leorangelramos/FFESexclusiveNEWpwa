<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FFES | Presente Simples do vs does</title>
    <link rel="stylesheet" href="../style.css">
    <style>
        /* === ESTILO UNIFICADO (PADRÃO PWA - MANTIDO 100%) === */
        
        /* Layout Principal */
        .game-wrapper {
            width: 100%;
            max-width: 600px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            z-index: 10;
            margin: 0 auto;
        }

        /* Card do Jogo (Glassmorphism) */
        .game-card {
            background: var(--glass-bg);
            backdrop-filter: var(--glass-blur);
            -webkit-backdrop-filter: var(--glass-blur);
            border: 2px solid var(--accent-gold);
            border-radius: 24px;
            padding: 30px 20px;
            text-align: center;
            box-shadow: var(--glass-shadow);
            min-height: 180px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        /* Tipografia do Display */
        #display, #display-sentence {
            font-size: 1.8rem;
            font-weight: 700;
            line-height: 1.4;
            color: var(--text-white);
            text-shadow: 0 2px 10px rgba(0,0,0,0.5);
            z-index: 2;
        }

        /* Lacunas */
        .gap { 
            color: var(--accent-gold); 
            border-bottom: 3px solid var(--accent-gold); 
            padding: 0 8px; 
            display: inline-block; 
            min-width: 60px; 
        }

        /* Feedback Visual */
        #feedback {
            height: 30px;
            text-align: center;
            font-weight: 800;
            letter-spacing: 2px;
            text-transform: uppercase;
            transition: all 0.2s;
            opacity: 0;
            margin-bottom: 10px;
        }
        #feedback.visible { opacity: 1; transform: translateY(-5px); }

        /* Controles e Botões */
        .game-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            width: 100%;
        }

        .btn-option {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--glass-border);
            color: var(--text-white);
            padding: 20px;
            font-size: 1.3rem;
            font-weight: 800;
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.2s ease;
            backdrop-filter: var(--glass-blur);
            text-transform: capitalize;
        }

        .btn-option:hover {
            border-color: var(--accent-gold);
            background: rgba(255, 184, 28, 0.1);
            transform: translateY(-3px);
        }

        .btn-option.correct {
            background: #00e676 !important;
            color: #000 !important;
            border-color: #00e676 !important;
        }

        .btn-option.wrong {
            background: #ff1744 !important;
            opacity: 0.5;
        }

        /* XP Pill */
        .xp-pill {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--accent-gold);
            padding: 5px 15px;
            border-radius: 50px;
            color: var(--accent-gold);
            font-weight: 800;
            font-size: 1.1rem;
            margin-top: 10px;
            display: inline-block;
        }

        /* === Elementos Específicos (Teoria e Scramble) === */
        .theory-section { 
            background: rgba(255, 255, 255, 0.05); 
            backdrop-filter: blur(10px); 
            border: 1px solid rgba(255, 255, 255, 0.1); 
            border-radius: 20px; 
            padding: 2rem; 
            margin-bottom: 30px; 
            color: var(--text-white); 
        }
        
        .formula-box { 
            background: rgba(184, 134, 11, 0.1); 
            border-left: 4px solid var(--accent-gold); 
            padding: 15px; 
            margin: 20px 0; 
            border-radius: 0 10px 10px 0; 
            font-weight: bold; 
        }

        .mode-selector { 
            display: grid; 
            grid-template-columns: repeat(3, 1fr); 
            gap: 10px; 
            margin-bottom: 30px; 
        }
        
        .mode-btn { 
            background: rgba(255, 255, 255, 0.07); 
            border: 1px solid rgba(255, 255, 255, 0.1); 
            padding: 15px; 
            border-radius: 12px; 
            color: var(--text-white); 
            cursor: pointer; 
            font-weight: bold; 
            transition: 0.3s; 
        }
        
        .mode-btn:hover, .mode-btn.active { 
            background: rgba(184, 134, 11, 0.3); 
            border-color: var(--accent-gold); 
        }

        .word-pill { 
            display: inline-block; 
            padding: 10px 15px; 
            margin: 5px; 
            background: rgba(0,0,0,0.3); 
            border: 1px solid var(--accent-gold); 
            border-radius: 20px; 
            cursor: pointer; 
            font-weight: bold; 
            color: var(--accent-gold); 
        }
        
        #scramble-answer { 
            min-height: 40px; 
            border-bottom: 2px solid var(--accent-gold); 
            margin: 20px 0; 
            font-size: 1.4rem; 
            color: var(--text-white); 
            width: 100%; 
        }
        
        .text-gold { color: var(--accent-gold); }

        /* === ANIMAÇÃO CASSINO (Moedas) === */
        .casino-coin {
            position: fixed;
            width: 25px; height: 25px;
            background: var(--accent-gold);
            border-radius: 50%;
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.9), inset 0 0 5px rgba(255, 255, 255, 0.5);
            pointer-events: none; z-index: 9999;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
        }

        @keyframes coin-explosion {
            0% { transform: translate(-50%, -50%) scale(0.5) rotate(0deg); opacity: 1; }
            100% { transform: translate(var(--tx), var(--ty)) scale(1) rotate(720deg); opacity: 0; }
        }

        /* === NOVAS CLASSES DE ENGENHARIA === */
        .progress-track {
            width: 100%; height: 5px;
            background: rgba(255,255,255,0.1);
            position: fixed; top: 0; left: 0; z-index: 1000;
        }
        .progress-fill {
            height: 100%; background: var(--accent-gold);
            width: 0%; transition: width 0.3s ease;
            box-shadow: 0 0 10px var(--accent-gold);
        }

        .feedback-float {
            position: absolute; top: -15px; right: -10px;
            font-weight: 900; font-size: 0.9rem;
            color: var(--accent-gold); background: rgba(0,0,0,0.8);
            padding: 5px 12px; border-radius: 20px; border: 1px solid var(--accent-gold);
            opacity: 0; transform: translateY(10px);
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: 5;
        }
        .feedback-float.show { opacity: 1; transform: translateY(0) rotate(5deg); }

        .speed-badge {
            position: absolute; bottom: 10px; width: 100%; left: 0;
            text-align: center; font-size: 0.7rem; color: #00e676;
            font-weight: 800; letter-spacing: 1px; text-transform: uppercase;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-6px); }
            40%, 80% { transform: translateX(6px); }
        }
        .shake-effect { animation: shake 0.4s ease-in-out; }

    </style>
</head>
<body>
    <div class="background-glow glow-1"></div>
    
    <div class="progress-track"><div class="progress-fill" id="progress-bar"></div></div>

    <header class="glass-header">
        <h1>PRESENTE <span class="text-gold">SIMPLES</span></h1>
        <p class="subtitle">Módulo 01: Presente Simples</p>
        <div class="xp-pill">XP: <span id="xp-val">0</span></div>
    </header>

    <main style="max-width: 800px; margin: 0 auto; padding: 20px;">
        
        <section class="theory-section">
            <h2 class="text-gold">Rotinas e Fatos</h2>
            <p>Usado para verdades universais, hábitos e situações permanentes.</p>
            <div class="formula-box">SUJEITO + VERBO (I/You/We/They)</div>
            <div class="formula-box">SUJEITO + VERBO (S) (He/She/It)</div>
            <ul style="margin-left: 20px; opacity: 0.9;">
                <li><strong>Do (I, You, We, They) / Does (He, She, It).</strong></li>
                <li><strong>Afirmativa:</strong> She work<strong>s</strong>.</li>
                <li><strong>Negativa:</strong> She <strong>doesn't</strong> work.</li>
                <li><strong>Interrogativa:</strong> <strong>Does</strong> she work?</li>
            </ul>
        </section>

        <div class="mode-selector">
            <button class="mode-btn" onclick="startGame('mc')">Múltipla Escolha</button>
            <button class="mode-btn" onclick="startGame('scramble')">Ordenar</button>
            <button class="mode-btn" onclick="startGame('translation')">Tradução</button>
        </div>

        <div id="game-container" class="game-wrapper">
            <div id="feedback"></div>

            <div class="game-card" id="game-card-element">
                <div id="combo-feedback" class="feedback-float">COMBO x2</div>
                <div id="speed-feedback" class="speed-badge"></div>

                <div id="display-sentence">Prepare-se...</div>
                
                <div id="scramble-ui" style="display:none; width: 100%;">
                    <div id="scramble-answer"></div>
                    <div id="scramble-pool"></div>
                </div>
            </div>

            <div class="game-controls" id="ab-controls">
                <button id="btn1" class="btn-option" onclick="checkAnswer(1)">A</button>
                <button id="btn2" class="btn-option" onclick="checkAnswer(2)">B</button>
            </div>
            
            <button id="btn-check-scramble" class="btn-option" style="display:none; width:100%" onclick="verifyScramble()">VERIFICAR</button>
        </div>
    </main>

    <footer class="glass-footer">
        © 2026 FFES - Sovereignty System v2.1
    </footer>

    <script>
        // === 1. BANCO DE DADOS MASSIVO (100+ Verbos / Sem Objeto) ===
        // Estrutura atômica para fluxo rápido.
        const verbList = [
            // Intransitivos ou de uso comum absoluto
            {v: "work", pt: "trabalha"}, {v: "play", pt: "joga"}, {v: "study", pt: "estuda"}, {v: "live", pt: "mora"}, 
            {v: "eat", pt: "come"}, {v: "drink", pt: "bebe"}, {v: "sleep", pt: "dorme"}, {v: "run", pt: "corre"}, 
            {v: "walk", pt: "anda"}, {v: "talk", pt: "conversa"}, {v: "speak", pt: "fala"}, {v: "listen", pt: "escuta"}, 
            {v: "watch", pt: "assiste"}, {v: "read", pt: "lê"}, {v: "write", pt: "escreve"}, {v: "cook", pt: "cozinha"}, 
            {v: "drive", pt: "dirige"}, {v: "fly", pt: "voa"}, {v: "swim", pt: "nada"}, {v: "jump", pt: "pula"}, 
            {v: "dance", pt: "dança"}, {v: "sing", pt: "canta"}, {v: "draw", pt: "desenha"}, {v: "paint", pt: "pinta"}, 
            {v: "clean", pt: "limpa"}, {v: "wash", pt: "lava"}, {v: "fix", pt: "conserta"}, {v: "break", pt: "quebra"}, 
            {v: "buy", pt: "compra"}, {v: "sell", pt: "vende"}, {v: "pay", pt: "paga"}, {v: "cost", pt: "custa"}, 
            {v: "meet", pt: "encontra"}, {v: "know", pt: "sabe"}, {v: "think", pt: "pensa"}, {v: "understand", pt: "entende"}, 
            {v: "learn", pt: "aprende"}, {v: "teach", pt: "ensina"}, {v: "help", pt: "ajuda"}, {v: "wait", pt: "espera"}, 
            {v: "start", pt: "começa"}, {v: "stop", pt: "para"}, {v: "finish", pt: "termina"}, {v: "open", pt: "abre"}, 
            {v: "close", pt: "fecha"}, {v: "win", pt: "ganha"}, {v: "lose", pt: "perde"}, {v: "cry", pt: "chora"}, 
            {v: "laugh", pt: "ri"}, {v: "smile", pt: "sorri"}, {v: "shout", pt: "grita"}, {v: "call", pt: "liga"}, 
            {v: "travel", pt: "viaja"}, {v: "visit", pt: "visita"}, {v: "love", pt: "ama"}, {v: "hate", pt: "odeia"}, 
            {v: "like", pt: "gosta"}, {v: "want", pt: "quer"}, {v: "need", pt: "precisa"}, {v: "prefer", pt: "prefere"}, 
            {v: "hope", pt: "espera (ter esperança)"}, {v: "wish", pt: "deseja"}, {v: "believe", pt: "acredita"}, 
            {v: "remember", pt: "lembra"}, {v: "forget", pt: "esquece"}, {v: "try", pt: "tenta"}, {v: "use", pt: "usa"}, 
            {v: "stand", pt: "fica de pé"}, {v: "sit", pt: "senta"}, {v: "lie", pt: "mente/deita"}, {v: "die", pt: "morre"}, 
            {v: "fight", pt: "luta"}, {v: "look", pt: "olha"}, {v: "seem", pt: "parece"}, {v: "feel", pt: "sente"},
            {v: "agree", pt: "concorda"}, {v: "disagree", pt: "discorda"}, {v: "answer", pt: "responde"}, {v: "ask", pt: "pergunta"},
            {v: "arrive", pt: "chega"}, {v: "leave", pt: "parte/sai"}, {v: "stay", pt: "fica"}, {v: "change", pt: "muda"},
            {v: "grow", pt: "cresce"}, {v: "cut", pt: "corta"}, {v: "fall", pt: "cai"}, {v: "hear", pt: "ouve"},
            {v: "hurry", pt: "apressa-se"}, {v: "worry", pt: "preocupa-se"}, {v: "care", pt: "se importa"}, {v: "share", pt: "compartilha"},
            {v: "push", pt: "empurra"}, {v: "pull", pt: "puxa"}, {v: "throw", pt: "arremessa"}, {v: "catch", pt: "pega"}
        ];

        const subjects = [
            {en: "I", aux: "Do", pt: "Eu"}, {en: "You", aux: "Do", pt: "Você"}, {en: "We", aux: "Do", pt: "Nós"}, {en: "They", aux: "Do", pt: "Eles"},
            {en: "He", aux: "Does", pt: "Ele"}, {en: "She", aux: "Does", pt: "Ela"}, {en: "It", aux: "Does", pt: "Isso"}, 
            {en: "Pedro", aux: "Does", pt: "Pedro"}, {en: "Ana", aux: "Does", pt: "Ana"}, {en: "Your dad", aux: "Does", pt: "Seu pai"},
            {en: "Your friends", aux: "Do", pt: "Seus amigos"}, {en: "The dog", aux: "Does", pt: "O cachorro"}
        ];

        let database = [];

        // Gerador Dinâmico de Frases
        function buildDatabase() {
            database = [];
            for(let i=0; i<300; i++) { // Gerar 300 variações
                const s = subjects[Math.floor(Math.random() * subjects.length)];
                const v = verbList[Math.floor(Math.random() * verbList.length)];
                // Montar frase: Aux + S + V?
                database.push({
                    en: `${s.aux} ${s.en.toLowerCase()} ${v.v}?`, // Ex: Do you work?
                    pt: `${s.pt} ${v.pt}?`, // Ex: Você trabalha?
                    s: s.en,
                    v: v.v,
                    aux: s.aux
                });
            }
        }
        buildDatabase(); // Inicializa

        // === 2. ENGINE DO JOGO ===
        let xp = parseInt(localStorage.getItem('ffes_xp') || 0);
        document.getElementById('xp-val').innerText = xp;
        
        let state = {
            mode: '',
            currentQ: null,
            correctIdx: 0,
            userScramble: [],
            combo: 0,
            startTime: 0
        };

        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

        function startGame(mode) {
            state.mode = mode;
            state.combo = 0; 
            document.getElementById('game-container').style.display = 'flex';
            document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
            
            const abControls = document.getElementById('ab-controls');
            const scCheck = document.getElementById('btn-check-scramble');
            const display = document.getElementById('display-sentence');
            const scrambleUI = document.getElementById('scramble-ui');
            
            if (mode === 'scramble') {
                abControls.style.display = 'none';
                scCheck.style.display = 'block';
                display.style.display = 'none';
                scrambleUI.style.display = 'block';
            } else {
                abControls.style.display = 'grid';
                scCheck.style.display = 'none';
                display.style.display = 'block';
                scrambleUI.style.display = 'none';
            }
            generate();
        }

        function generate() {
            document.querySelectorAll('.btn-option').forEach(b => {
                b.className = 'btn-option';
                if(b.id === 'btn-check-scramble') b.innerText = "VERIFICAR";
            });
            document.getElementById('feedback').className = ''; 
            document.getElementById('feedback').innerText = '';
            document.getElementById('speed-feedback').innerText = "";

            // Seleção randomica da big list
            const item = database[Math.floor(Math.random() * database.length)];
            state.currentQ = item;
            state.startTime = Date.now();

            const display = document.getElementById('display-sentence');
            
            if (state.mode === 'mc') {
                // Capitalizar primeira letra do sujeito se for inicio de frase visualmente (aqui não é, pois tem Do/Does antes)
                // Mas nomes próprios como Pedro sim. Já está no objeto.
                display.innerHTML = `<span class="gap">_____</span> ${item.s.toLowerCase() === 'i' ? 'I' : (item.s === 'Pedro' || item.s === 'Ana' ? item.s : item.s.toLowerCase())} ${item.v}?`;
                if(Math.random() > 0.5) {
                    setOptions("Do", "Does", item.aux);
                } else {
                    setOptions("Does", "Do", item.aux);
                }
            } 
            else if (state.mode === 'translation') {
                display.innerHTML = `"${item.pt}"`;
                const correct = item.en;
                // Ajuste fino na geração do erro para ficar natural
                const wrongAux = item.aux === "Do" ? "Does" : "Do";
                // Regex simples para substituir apenas a primeira ocorrência do auxiliar
                const wrong = item.en.replace(item.aux, wrongAux);
                
                if(Math.random() > 0.5) {
                    setOptions(correct, wrong, correct);
                } else {
                    setOptions(wrong, correct, correct);
                }
            } 
            else if (state.mode === 'scramble') {
                setupScramble(item);
            }
        }

        function setOptions(txt1, txt2, correctVal) {
            const btn1 = document.getElementById('btn1');
            const btn2 = document.getElementById('btn2');
            btn1.innerText = txt1; 
            btn1.onclick = () => checkAnswer(txt1 === correctVal, btn1);
            btn2.innerText = txt2; 
            btn2.onclick = () => checkAnswer(txt2 === correctVal, btn2);
        }

        function setupScramble(item) {
            state.userScramble = [];
            const pool = document.getElementById('scramble-pool');
            const ans = document.getElementById('scramble-answer');
            pool.innerHTML = "";
            ans.innerText = "";
            
            // Clean question mark for shuffling but add to check
            let cleanEn = item.en.replace('?', ' ?');
            let words = cleanEn.split(" ");
            words.sort(() => Math.random() - 0.5);
            
            words.forEach(w => {
                const pill = document.createElement('span');
                pill.className = 'word-pill';
                pill.innerText = w;
                pill.onclick = () => {
                    state.userScramble.push(w);
                    ans.innerText = state.userScramble.join(" ");
                    pill.style.display = 'none';
                    playAudio('click');
                };
                pool.appendChild(pill);
            });
        }

        function verifyScramble() {
            const btn = document.getElementById('btn-check-scramble');
            // Reconstruct with question mark logic handled roughly
            const userStr = state.userScramble.join(" ").replace(' ?', '?');
            if (userStr === state.currentQ.en) {
                checkAnswer(true, btn);
            } else {
                checkAnswer(false, btn);
                setTimeout(() => {
                    btn.classList.remove('wrong');
                    setupScramble(state.currentQ);
                }, 1000);
            }
        }

        function checkAnswer(isCorrect, element) {
            const fb = document.getElementById('feedback');
            const timeDelta = Date.now() - state.startTime;
            const isSpeed = timeDelta < 2000;

            if (isCorrect) {
                state.combo++;
                let xpGain = 10 + (state.combo * 2);
                if(isSpeed) xpGain += 5;
                addXP(xpGain);
                
                fb.innerText = "PERFEITO!"; fb.style.color = "#00e676"; fb.className = "visible";
                element.classList.add('correct');
                
                // === LÓGICA DE ÁUDIO AVANÇADA ===
                if (state.combo % 10 === 0) {
                    playAudio('milestone'); // Som Épico x10, x20...
                    triggerCasinoEffect(50); // Chuva massiva
                } else if (state.combo > 1) {
                    playAudio('combo'); // Som Arcade Crescente
                } else {
                    playAudio('win'); // Som Normal
                }
                
                if(isSpeed) document.getElementById('speed-feedback').innerText = "⚡ HACKER SPEED!";

                const comboEl = document.getElementById('combo-feedback');
                comboEl.innerText = `COMBO x${state.combo}`;
                comboEl.classList.add('show');

                let w = parseFloat(document.getElementById('progress-bar').style.width || 0);
                document.getElementById('progress-bar').style.width = (w + 10) % 100 + '%';
                
                // Efeitos visuais extras
                if(state.combo % 5 === 0) triggerCasinoEffect(20);

                setTimeout(() => {
                    comboEl.classList.remove('show');
                    generate();
                }, 1200);

            } else {
                state.combo = 0;
                addXP(-5);
                fb.innerText = "TENTE NOVAMENTE"; fb.style.color = "#ff1744"; fb.className = "visible";
                element.classList.add('wrong');
                playAudio('error');
                
                const card = document.getElementById('game-card-element');
                card.classList.add('shake-effect');
                setTimeout(() => card.classList.remove('shake-effect'), 400);
                document.getElementById('combo-feedback').classList.remove('show');
            }
        }

        function addXP(val) {
            xp = Math.max(0, xp + val); 
            localStorage.setItem('ffes_xp', xp);
            document.getElementById('xp-val').innerText = xp;
        }

        // === 3. DRIVER DE ÁUDIO PRO (3 TIPOS) ===
        function playAudio(type) {
            if (audioCtx.state === 'suspended') { audioCtx.resume(); }
            const t = audioCtx.currentTime;
            
            if(type === 'milestone') {
                // === SOM TIPO 3: MILESTONE (Acorde Maior Glorioso) ===
                // Toca C-E-G-C (Dó Maior) rápido (arpeggio)
                const frequencies = [523.25, 659.25, 783.99, 1046.50]; // C5, E5, G5, C6
                frequencies.forEach((f, i) => {
                    const osc = audioCtx.createOscillator();
                    const gain = audioCtx.createGain();
                    osc.type = 'triangle'; // Suave mas brilhante
                    osc.frequency.setValueAtTime(f, t + (i * 0.1)); // Atraso leve entre notas
                    gain.gain.setValueAtTime(0.1, t + (i * 0.1));
                    gain.gain.exponentialRampToValueAtTime(0.01, t + (i * 0.1) + 0.6);
                    osc.connect(gain);
                    gain.connect(audioCtx.destination);
                    osc.start(t + (i * 0.1));
                    osc.stop(t + (i * 0.1) + 0.6);
                });

            } else if(type === 'combo') {
                // === SOM TIPO 2: COMBO (Arcade Rising Pitch) ===
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                osc.connect(gain);
                gain.connect(audioCtx.destination);
                
                osc.type = 'square'; // 8-bit style
                // Frequência base sobe com o combo. Limitada a 1200Hz para não doer o ouvido.
                const baseFreq = Math.min(300 + (state.combo * 50), 1200);
                
                osc.frequency.setValueAtTime(baseFreq, t);
                osc.frequency.linearRampToValueAtTime(baseFreq + 200, t + 0.15); // Slide up
                
                gain.gain.setValueAtTime(0.08, t);
                gain.gain.exponentialRampToValueAtTime(0.01, t + 0.2);
                osc.start(t); osc.stop(t + 0.2);

            } else if(type === 'win') {
                // === SOM TIPO 1: NORMAL (Ping Suave) ===
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                osc.connect(gain);
                gain.connect(audioCtx.destination);
                
                osc.type = 'sine';
                osc.frequency.setValueAtTime(800, t);
                gain.gain.setValueAtTime(0.05, t);
                gain.gain.exponentialRampToValueAtTime(0.01, t + 0.15);
                osc.start(t); osc.stop(t + 0.15);

            } else if(type === 'error') {
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                osc.connect(gain);
                gain.connect(audioCtx.destination);
                osc.type = 'sawtooth';
                osc.frequency.setValueAtTime(150, t);
                osc.frequency.linearRampToValueAtTime(100, t + 0.2);
                gain.gain.exponentialRampToValueAtTime(0.01, t + 0.3);
                osc.start(t); osc.stop(t + 0.3);

            } else { // Click
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                osc.connect(gain);
                gain.connect(audioCtx.destination);
                osc.frequency.setValueAtTime(1200, t);
                gain.gain.exponentialRampToValueAtTime(0.01, t + 0.05);
                osc.start(t); osc.stop(t + 0.05);
            }
        }

        function triggerCasinoEffect(amount = 20) {
            for (let i = 0; i < amount; i++) {
                const coin = document.createElement('div');
                coin.classList.add('casino-coin');
                
                const angle = Math.random() * Math.PI * 2;
                const distance = 150 + Math.random() * 200;
                const tx = Math.cos(angle) * distance + 'px';
                const ty = Math.sin(angle) * distance + 'px';
                
                coin.style.setProperty('--tx', tx);
                coin.style.setProperty('--ty', ty);
                coin.style.animation = `coin-explosion ${0.8 + Math.random() * 0.5}s ease-out forwards`;
                
                document.body.appendChild(coin);
                setTimeout(() => { coin.remove(); }, 1500);
            }
        }
    </script>
</body>
</html>