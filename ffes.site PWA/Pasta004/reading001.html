<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FFES | Reading Zone (A1)</title>
    <link rel="stylesheet" href="../style.css">
    <style>
        .exercise-box {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 1.5rem;
            margin-top: 20px;
        }
        .game-area {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        @media (max-width: 600px) { .game-area { grid-template-columns: 1fr; } }

        .column-box {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 15px;
            padding: 15px;
            min-height: 300px;
            border: 1px dashed rgba(255, 255, 255, 0.1);
        }
        .paragraph-block {
            background: rgba(184, 134, 11, 0.1);
            border: 1px solid rgba(184, 134, 11, 0.3);
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 8px;
            cursor: grab;
            color: #fff;
            font-size: 0.95rem;
            line-height: 1.4;
        }
        .paragraph-block:active { cursor: grabbing; }
        .paragraph-block.dragging { opacity: 0.4; }

        .drop-zone {
            background: rgba(255, 255, 255, 0.05);
            border: 2px dashed rgba(184, 134, 11, 0.2);
            border-radius: 10px;
            min-height: 60px;
            margin-bottom: 10px;
            transition: 0.3s;
        }
        .drop-zone.hovered {
            background: rgba(184, 134, 11, 0.15);
            border-color: #b8860b;
        }
        .column-title {
            text-align: center;
            font-size: 0.9rem;
            color: #b8860b;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
    </style>
</head>
<body class="dashboard-container">

    <div class="background-glow glow-2"></div>

    <header class="glass-header">
        <h1>READING <span class="text-gold">ZONE</span></h1>
        <p class="subtitle">Módulo 04 - Ordenação de Parágrafos (A1)</p>
    </header>

    <main style="max-width: 900px; margin: 0 auto; padding: 20px;">
        
        <div id="game-content" class="exercise-box">
            <h2 id="story-title" style="color: #fff; text-align: center; margin-bottom: 20px;">Carregando...</h2>
            
            <div class="game-area">
                <div id="source" class="column-box" ondragover="allowDrop(event)" ondrop="drop(event)">
                    <div class="column-title">Fragmentos</div>
                </div>
                
                <div id="target" class="column-box">
                    <div class="column-title">Sua Ordem</div>
                    </div>
            </div>

            <div id="feedback" style="text-align:center; margin-top:20px; font-weight:bold; min-height:24px;"></div>

            <div style="margin-top: 20px; display: flex; gap: 10px; justify-content: center;">
                <button onclick="checkOrder()" class="btn-gold">VERIFICAR</button>
                <button id="nextBtn" onclick="nextStory()" class="btn-gold" style="display:none; background: transparent; border: 1px solid #b8860b;">PRÓXIMA ➡</button>
            </div>
        </div>

        <div style="margin-top: 40px; text-align: center;">
            <a href="../index.html" class="card-glass" style="display: inline-block; padding: 12px 35px; text-decoration: none;">
                <span>⬅ Voltar ao Painel</span>
            </a>
        </div>
    </main>

    <script>
        const stories = [
            {
                title: "My Cat, Leo",
                paragraphs: [
                    "I have a pet. He is a cat and his name is Leo.",
                    "Leo is 3 years old. He is a small cat. His fur is black and white.",
                    "He sleeps a lot. He also likes to play with a ball.",
                    "Leo is part of my family. I love my cat."
                ]
            }
        ];

        let currentIdx = 0;
        let draggedItem = null;

        function load() {
            const story = stories[currentIdx];
            document.getElementById('story-title').textContent = story.title;
            const source = document.getElementById('source');
            const target = document.getElementById('target');
            
            source.innerHTML = '<div class="column-title">Fragmentos</div>';
            target.innerHTML = '<div class="column-title">Sua Ordem</div>';
            
            // Fragmentos embaralhados
            const scrambled = [...story.paragraphs].sort(() => Math.random() - 0.5);
            scrambled.forEach((text, i) => {
                const div = document.createElement('div');
                div.className = 'paragraph-block';
                div.textContent = text;
                div.draggable = true;
                div.id = 'p-' + i;
                div.addEventListener('dragstart', (e) => draggedItem = e.target);
                source.appendChild(div);
            });

            // Criar zonas de drop
            story.paragraphs.forEach((_, i) => {
                const zone = document.createElement('div');
                zone.className = 'drop-zone';
                zone.addEventListener('dragover', (e) => { e.preventDefault(); zone.classList.add('hovered'); });
                zone.addEventListener('dragleave', () => zone.classList.remove('hovered'));
                zone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    zone.classList.remove('hovered');
                    if(zone.children.length === 0) zone.appendChild(draggedItem);
                });
                target.appendChild(zone);
            });
        }

        function allowDrop(e) { e.preventDefault(); }
        function drop(e) {
            e.preventDefault();
            if(e.target.id === 'source') e.target.appendChild(draggedItem);
        }

        function checkOrder() {
            const zones = document.querySelectorAll('.drop-zone');
            const story = stories[currentIdx];
            let correct = true;

            zones.forEach((zone, i) => {
                if(!zone.firstElementChild || zone.firstElementChild.textContent !== story.paragraphs[i]) {
                    correct = false;
                }
            });

            const feedback = document.getElementById('feedback');
            if(correct) {
                feedback.innerHTML = "<span style='color: #4ade80'>HISTÓRIA COESA: +30 XP</span>";
                document.getElementById('nextBtn').style.display = "block";
                
                let xp = localStorage.getItem('ffes_xp') || 0;
                localStorage.setItem('ffes_xp', parseInt(xp) + 30);
            } else {
                feedback.innerHTML = "<span style='color: #f87171'>ORDEM INCORRETA</span>";
            }
        }

        load();
    </script>

    <footer class="glass-footer">
        <p>&copy; 2026 FFES - Sovereignty System v2.1</p>
    </footer>

</body>
</html>